[package]
name = "defuse-wallet"
edition.workspace = true
version = "0.1.0"
rust-version.workspace = true
repository.workspace = true

[lib]
crate-type = ["cdylib", "rlib"]

[lints]
workspace = true

[dependencies]
defuse-borsh-utils.workspace = true
defuse-deadline.workspace = true

near-sdk = { workspace = true, features = ["deterministic-account-ids"] }
thiserror.workspace = true

defuse-crypto = { workspace = true, default-features = false, optional = true }
defuse-webauthn = { workspace = true, default-features = false, optional = true }

arbitrary = { workspace = true, features = ["derive"], optional = true }

[features]
default = ["webauthn", "no-sign"]

webauthn = ["dep:defuse-webauthn"]
webauthn-ed25519 = ["webauthn", "defuse-webauthn/ed25519"]
webauthn-p256 = ["webauthn", "defuse-webauthn/p256"]

# Always reject the signature.
# This can be useful to deploy "1-of-M multisig"/"fan-out" wallet, where
# extensions are pre-defined at the initialization stage (i.e. state_init).
# So only extensions can execute requests via `w_execute_extension()`.
no-sign = []

abi = ["defuse-crypto/abi", "defuse-deadline/abi", "defuse-webauthn?/abi"]
arbitrary = ["dep:arbitrary", "near-sdk/arbitrary"]
contract = []


[dev-dependencies]
defuse-wallet = { workspace = true, features = ["arbitrary"] }
defuse-crypto.workspace = true
defuse-tests.workspace = true

arbitrary = { workspace = true, features = ["derive"] }
impl-tools.workspace = true
near-sdk = { workspace = true, features = [
    "deterministic-account-ids",
    "unit-testing",
] }
rstest.workspace = true
tokio = { workspace = true, features = ["macros"] }
